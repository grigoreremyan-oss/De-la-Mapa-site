# ТЕХНИЧЕСКОЕ ЗАДАНИЕ

## Mobile “Liquid Glass” Assistant Widget + Visual Admin Panel

---

## 0. Общая идея

Необходимо создать **два слоя ПО**:

1. **Виджет ассистента** — подключаемый на сайт одним `<script>`, предназначен для мобильных устройств, с эффектом *liquid glass* (матово-прозрачное стекло, плавная пружинная анимация, ощущение “живого” элемента).
2. **Визуальная админка** — интерфейс для настройки виджета без программиста, с live-preview и окном “Скопировать код для вставки на сайт”.

Проект должен быть реализован как **продукт**, готовый к обновлениям, интеграциям и расширению.

---

## 1. Цели

* Максимально плавный и “дорогой” UX на мобильных (iOS/Android).
* Полное управление контентом виджета через админку:

  * лого кнопки
  * иконки мессенджеров
  * номер телефона
  * ссылки на WhatsApp / Telegram (переход сразу в чат)
  * быстрые кнопки (Бронирование / Акции / Написать)
  * тексты
  * версия для левши / правши
* Простая установка: **копипаст одного скрипта**.
* Без влияния на скорость загрузки сайта.

---

## 2. Поддерживаемая среда

* Основной фокус: **mobile**

  * iOS Safari
  * Android Chrome
* Виджет активен при ширине экрана `≤ 768px`.
* Обязательно учитывать **safe-area** на iOS:

  * нижний отступ: `16px + env(safe-area-inset-bottom)`
* Поддержка `prefers-reduced-motion`.

---

## 3. Архитектура (обязательные слои)

### 3.1 Виджет (frontend, embed)

* Подключается одной строкой:

```html
<script
  src="https://domain.com/assistant-widget/widget.js?v=1.0.0"
  data-config="https://domain.com/assistant-widget/config.json"
  defer>
</script>
```

* Не блокирует загрузку страницы.
* Загружает конфигурацию по URL из `data-config`.

---

### 3.2 Админка (frontend)

* Отдельная страница, например `/widget-admin`.
* Только для владельца сайта (закрыта авторизацией).
* Позволяет:

  * редактировать все настройки виджета
  * видеть live-preview (эмуляция телефона)
  * копировать код установки виджета

---

### 3.3 Конфиг (data layer)

* Формат: `config.json`
* Хранит все настройки виджета.
* Загружается виджетом при инициализации.
* Версионируется (`version` в конфиге).

---

### 3.4 Backend / API (минимальный)

Нужен для:

* сохранения `config.json`
* загрузки файлов (лого, иконки)
* (опционально) аналитики

Минимальные endpoints:

* `GET /assistant-widget/config.json`
* `PUT /assistant-widget/config.json`
* `POST /assistant-widget/upload`

---

### 3.5 Storage

* Хранение файлов:

  * лого FAB
  * иконки мессенджеров
* Форматы: `png`, `svg`, `webp`
* Ограничение размера: ≤ 300 KB

---

## 4. Виджет: UI и поведение

### 4.1 FAB (основная кнопка)

* Круглая кнопка 56px
* Позиция:

  * по умолчанию — **правша (нижний правый угол)**
  * поддержка левши (нижний левый)
* Внешний вид:

  * liquid glass
  * лого из админки
* Hit-area ≥ 44px

---

### 4.2 Раскрытие

По тапу на FAB:

**Горизонтально (внутрь экрана):**

* кнопки:

  * Бронирование
  * Акции
  * Написать

**Вертикально (вверх):**

* Телефон
* WhatsApp
* Telegram
  (список управляется из админки)

---

### 4.3 Mini-dialog (bubble)

* Появляется над FAB
* Текст задаётся в админке
* Пример:

  > “Как могу вам помочь? Нужна помощь с бронированием?”

---

### 4.4 Левша / правша

* В админке задаётся `sideDefault`
* В самом виджете есть быстрый переключатель:

  * «Версия для правши»
  * «Версия для левши»
* Выбор пользователя:

  * сохраняется в `localStorage`
  * перекрывает значение из конфига
* При смене стороны зеркалится:

  * позиция
  * направление раскрытия
  * положение bubble

---

## 5. Анимации и “ощущение живого виджета”

### 5.1 Общие правила

* Анимировать **только**:

  * `transform`
  * `opacity`
* Не использовать анимации `width / height / top / left`.

---

### 5.2 Открытие

* Длительность: 220–320 ms
* Тип: spring / overshoot
* Эффект:

  * лёгкое “сжатие + растяжение” FAB
  * мягкий отскок панелей

---

### 5.3 Закрытие

* 180–260 ms
* Мягкое схлопывание без резкости

---

### 5.4 Reduced motion

Если `prefers-reduced-motion = true`:

* без overshoot
* простое fade + translate

---

## 6. Визуальный стиль “Liquid Glass”

### 6.1 Основной режим

* `backdrop-filter: blur(12–18px) saturate(140–180%)`
* Полупрозрачный фон
* Тонкий светлый контур
* Мягкая тень
* Лёгкий блик (gradient)

---

### 6.2 Fallback

Если `backdrop-filter` не поддерживается:

* без blur
* прозрачность + градиент + тень
* внешний вид остаётся аккуратным

---

## 7. Админка: функционал

### 7.1 Настройки

**FAB**

* загрузка лого
* предпросмотр

**Телефон**

* номер
* подпись
* `tel:` ссылка

**Мессенджеры**

* включить / выключить
* иконка (upload)
* ссылка в чат
* порядок (drag & drop)

**Быстрые кнопки**

* включить / выключить
* заголовок
* иконка
* действие:

  * переход по ссылке
  * открыть mini-chat
* порядок

**Тексты**

* bubble-текст

**Поведение**

* сторона по умолчанию (левша / правша)

---

### 7.2 Live Preview

* Макет смартфона
* Переключатели:

  * левша / правша
* Мгновенное отображение изменений

---

### 7.3 Установка (очень важно)

В админке должен быть отдельный блок:

**“Установка виджета на сайт”**

* отображается готовый `<script>` код
* кнопка **«Скопировать»**
* текст-подсказка:

  > «Вставьте код перед закрывающим `</body>` на сайте»

---

## 8. Конфиг (пример)

```json
{
  "version": 1,
  "sideDefault": "right",
  "fab": {
    "logoUrl": "/uploads/fab.webp"
  },
  "texts": {
    "bubble": "Как могу вам помочь? Нужна помощь с бронированием?"
  },
  "phone": {
    "enabled": true,
    "tel": "+431234567"
  },
  "messengers": [
    {
      "id": "whatsapp",
      "enabled": true,
      "iconUrl": "/uploads/wa.svg",
      "href": "https://wa.me/431234567"
    },
    {
      "id": "telegram",
      "enabled": true,
      "iconUrl": "/uploads/tg.svg",
      "href": "https://t.me/hotel"
    }
  ],
  "actions": [
    {
      "id": "booking",
      "enabled": true,
      "title": "Бронирование",
      "type": "link",
      "href": "/booking"
    }
  ]
}
```

---

## 9. Аналитика (минимум)

События:

* показ виджета
* открытие / закрытие
* клики по кнопкам
* клики по мессенджерам

Реализация:

* через `dataLayer` или API (опционально)

---

## 10. Структура проекта (рекомендуемая)

```
/assistant-widget/
  widget.js
  widget.css
  config.json
/widget-admin/
  index.html
  admin.js
  admin.css
/uploads/assistant-widget/
/README.md
```

---

## 11. Документация

В `README.md`:

* как установить виджет
* как пользоваться админкой
* как поменять телефон / мессенджеры
* куда вставлять код
* ограничения iOS / Android

---

## 12. Критерии приёмки

* Виджет плавный, без лагов
* Safe-area соблюдён
* Левша / правша работает корректно
* Админка реально управляет виджетом
* Код установки копируется и работает
* Есть fallback без blur
* Есть документация

---

## 13. Рекомендуемый порядок реализации

1. Виджет + config.json
2. Анимации и liquid glass
3. Админка (редактор + preview)
4. Upload файлов
5. Копирование embed-кода
6. Аналитика
7. Полировка
